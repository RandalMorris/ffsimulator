Adds new features and corrects failed donttest issue as requested by CRAN.

## Test environments
* local Windows 10 environment,             R 4.1.0
* macOS-release        (on GitHub Actions), R 4.1.0
* windows-release      (on GitHub Actions), R 4.1.0 
* ubuntu 20.04         (on GitHub Actions), R 4.1.0
* ubuntu 20.04         (on GitHub Actions), R-devel

## R CMD check results

0 errors | 0 warnings | 0 note
